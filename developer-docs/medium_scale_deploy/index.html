<!DOCTYPE html>
<html>
  
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

	<title>Medium Scale Deployment - Sunbird</title>

	<meta name="keywords" content="Learn, Collaborate, Contribute, Open Source, Movement" />
	<meta name="description" content="About how developer can deploy" />

	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-touch-fullscreen" content="yes" />
	<link rel="icon" type="image/png" href="/img/favicon/favicon-16x16.png" sizes="16x16">

	<meta name="msapplication-TileColor" content="#65d3f7">
	<meta name="msapplication-TileImage" content="/img/favicon/mstile-150x150.png">

	<!-- Open Graph tags -->
	<meta property="og:title" content="Medium Scale Deployment - Sunbird" />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="/developer-docs/medium_scale_deploy/" />
	<meta property="og:image" content="/img/og_image.png" />
	<meta property="og:description" content="About how developer can deploy" />

	<!-- Twitter Card tags -->
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:site" content="@sunbird" />
	<meta name="twitter:title" content="Medium Scale Deployment" />
	<meta name="twitter:description" content="About how developer can deploy" />
	<meta name="twitter:image" content="/img/og_image.png" />
	
	<meta http-equiv="cache-control" content="max-age=0" />
	<meta http-equiv="cache-control" content="no-cache" />
	<meta http-equiv="expires" content="0" />
	<meta http-equiv="expires" content="Tue, 01 Jan 2018 1:00:00 GMT" />
	<meta http-equiv="pragma" content="no-cache" />

	<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,600,700" rel="stylesheet">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

	<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
	<script type="text/javascript" src="/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="/js/owl.carousel.min.js"></script>
	<script type="text/javascript" src="/js/all.js?1.0.0"></script>

	<link href="/css/owl/owl.carousel.min.css" rel="stylesheet" type="text/css" />
	<link href="/css/style.css?1.0.0" rel="stylesheet" type="text/css" />

	
	

	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments)};
	  gtag('js', new Date());

	  gtag('config', 'UA-106552125-1');
	</script>
</head>




  <body>
  <div class="container inner container-height docs">
    <header class="logo-container">
      <div class="logo">
        <a href="/">
          <img src="/img/sunbird-logo.png" alt="Sunbird docs" title="Sunbird docs">
        </a>
      </div>
      <button type="button" class="dropdown-toggle collapsed" id="dropdown-trigger" data-toggle="collapse" data-target="#mobile-dropdown" aria-expanded="false">
        <i class="fa fa-bars" aria-hidden="true"></i>
      </button>
    </header>
    <nav class="sidebar-container" id="mobile-dropdown">
      <!--<div class="inner__searchbar">
        <script type="text/javascript">$(function() { React.render(React.createElement(SearchBar, null), $("#9kkhxztrpa8")[0]); });</script><div id="9kkhxztrpa8"><div class="search" data-reactid=".fcy23ogfae" data-react-checksum="827432426"><div class="search-icon" data-reactid=".fcy23ogfae.0"><i class="material-icons" data-reactid=".fcy23ogfae.0.0">search</i></div><div class="search-bar" data-reactid=".fcy23ogfae.1"><form data-reactid=".fcy23ogfae.1.0"><input type="text" name="search" class="" autocomplete="off" placeholder="Search" value="" data-reactid=".fcy23ogfae.1.0.0"></form></div><div class="search-results" data-reactid=".fcy23ogfae.2"></div></div></div>
      </div>-->
      <div class="inner__sidebar">
        <div id="">
	<div class="sidebar-wrapper">
		<div class="" >
			<a href="/architecture">
				<h4 class="sidebar-group-title">Architecture</h4>
			</a>
			<ul class="sidebar-group" >
				<li>
					<a href="/architecture">Overview</a>
				</li>
				<li>
					<a href="/architecture/design">Design</a>
				</li>
				<li>
					<div class="">
						<h4 class="sidebar-group-title">Elementary Views</h4>
						<ul class="sidebar-group">
							<li>
								<a href="/architecture/views/logical">Logical View</a>
							</li>
							<li>
								<a href="/architecture/views/physical">Physical View</a>
							</li>
							<li>
								<a href="/architecture/views/conceptual">Conceptual View</a>
							</li>
							<li>
								<a href="/architecture/views/deployment">Deployment View</a>
							</li>
						</ul>
					</div>
				</li>
			</ul>
			<a href="/features-documentation/">
				<h4 class="sidebar-group-title">Product Features</h4>
			</a>
			<ul class="sidebar-group" >
				<li>
					<a href="/features-documentation/">Onboarding</a>
				</li>
				<li>
					<a href="/features-documentation/login">Login</a>
				</li>
				<li>
					<a href="/features-documentation/administration">Administration</a>
				</li>
				<li>
					<a href="/features-documentation/userrolepermission">User Roles and Permissions</a>
				</li>
				<li>
					<div class="">
						<ul class="sidebar-group">
							<li>
								<a href="/features-documentation/userprofile">User Profile</a>
							</li>
							<li>
								<a href="/features-documentation/workspace">Workspace</a>
							</li>
						</ul>
					</div>
				</li>
				<li>
					<a href="/features-documentation/coursetraining">Courses and Training</a>
				</li>
				<li>
					<a href="/features-documentation/resources">Resources</a>
				</li>
				<li>
					<div class="">
						<a href="/features-documentation/contentlifecycle" class="sidebar-group-title">Content Lifecycle</a>
						<ul class="sidebar-group">
							<li>
								<a href="/features-documentation/contentlifecycle">Content Creation</a>
							</li>
							<li>
								<a href="/features-documentation/review">Review</a>
							</li>
							<li>
								<a href="/features-documentation/publishing">Publishing</a>
							</li>
						</ul>
					</div>
				</li>
				<li>
					<a href="/features-documentation/contenteditor">Content Editor</a>
				</li>
				<li>
					<div class="">
						<a href="/features-documentation/guidelines" class="sidebar-group-title">Guidelines</a>
						<ul class="sidebar-group">
							<li>
								<a href="/features-documentation/intellectualproperty">Intellectual Property</a>
							</li>
							<li>
								<a href="/features-documentation/contentsubmission">Content Submission</a>
							</li>
							<li>
								<a href="/features-documentation/codesubmission">Code Submission</a>
							</li>
							<li>
								<a href="/features-documentation/review">Review</a>
							</li>
						</ul>
					</div>
				</li>
				<li>
					<div class="">
						<a href="/participate/">Participate</a>
						<!--<ul class="sidebar-group">
							<li>
								<a href="/participate/">Participation Process</a>
							</li>
							<li>
								<a href="#">Suggest Design</a>
							</li>
							<li>
								<a href="#">Write Documentation</a>
							</li>
							<li>
								<a href="#">Write Code</a>
							</li>
							<li>
								<a href="#">Test</a>
							</li>
							<li>
								<a href="#">Answer Questions</a>
							</li>
							<li>
								<a href="#">Review</a>
							</li>
							<li>
								<a href="#">Mentor</a>
							</li>
							<li>
								<a href="#">Maintain</a>
							</li>
						</ul>-->
					</div>
				</li>
				<li>
					<a href="/features-documentation/reportinganalytics">Reporting and Analytics</a>
				</li>
				<li>
					<a href="/features-documentation/collaborationpartnership">Collaboration and Partnership</a>
				</li>
				<li>
					<a href="/features-documentation/supportedenvironment">Supported Environments</a>
				</li>
			</ul>
			<a href="/developer-docs">
				<h4 class="sidebar-group-title">Developer Documentation</h4>
			</a>
			<ul class="sidebar-group" >
				<li>
					<a href="/developer-docs/getting_started/">Getting Started</a>
					<ul class="sidebar-group">
						<li>
							<a href="/developer-docs/getting_started/">Supported Environments</a>
						</li>
					</ul>
				</li>
				<li>
					<a href="/developer-docs/hosting_sunbird/">Hosting Sunbird</a>
				</li>
				<li>
					<div class="">
						<a class="sidebar-group-title" href="/developer-docs/developer_install/">Installing Sunbird</a>
						<ul class="sidebar-group">
							<li>
								<a href="/developer-docs/developer_install/#prerequisites">Prerequisites</a>
							</li>
							<!--<li>
								<a href="/developer-docs/developer_install/#setup">Quick Installation</a>
							</li>-->
							<li>
								<a href="/developer-docs/developer_install/#setup">Complete Installation Procedure</a>
							</li>
							<li>
								<a href="/developer-docs/medium_scale_deploy">Medium Scale Deployment</a>
							</li>
							<li>
								<a href="/developer-docs/large_scale_deploy">Large Scale Deployment</a>
							</li>
						</ul>
					</div>
				</li>
				<li>
					<div class="">
						<a class="sidebar-group-title" href="/developer-docs/extending_sunbird/">Extending Sunbird</a>
						<!--<ul class="sidebar-group">
							<li>
								<a href="/developer-docs/extending_sunbird/">Overview</a>
							</li>
							<li>
								<a href="/developer-docs/extending_sunbird/">Extension Points</a>
							</li>
							<li>
								<a href="/developer-docs/extending_sunbird/">Extension Options</a>
							</li>
						</ul>-->
					</div>
				</li>
				<li>
					<div class="">
						<a class="sidebar-group-title" href="/developer-docs/customize_sunbird/">Customizing Sunbird</a>
						<!--<ul class="sidebar-group">
							<li>
								<a href="/developer-docs/customize_sunbird/#changing-the-look-and-feel">Changing the Look and Feel</a>
							</li>
						</ul>-->
					</div>
				</li>
				<li>
					<div class="">
						<a class="sidebar-group-title" href="/apis/">API Reference</a>
						<ul class="sidebar-group">
							<li>
								<a href="/developer-docs/api_ref/">Custom Javascript Plugins</a>
							</li>
							<li>
								<a href="/apis/">Sunbird REST APIs</a>
							</li>
						</ul>
					</div>
				</li>
				<li>
					<div class="">
						<a class="sidebar-group-title">Code Contribution</a>
						<!--<ul class="sidebar-group">
							<li>
								<a href="/developer-docs/code_contribute/">Overview</a>
							</li>
							<li>
								<a href="/developer-docs/code_contribute/">Guidelines</a>
							</li>
							<li>
								<a href="/developer-docs/code_contribute/">Contributor Roles</a>
							</li>
						</ul>-->
					</div>
				</li>
			</ul>
			<a href="/faqs/">
				<h4 class="sidebar-group-title">Frequently asked questions</h4>
			</a>
			<ul class="sidebar-group" >
				<li>
					<a href="/faqs/audience">Audience</a>
				</li>
				<li>
					<a href="/faqs/contentcreation">Content Creation</a>
				</li>
				<li>
					<a href="/faqs/content_format">Content Format</a>
				</li>
				<li>
					<a href="/faqs/content_repo">Content Repo</a>
				</li>
				<li>
					<a href="/faqs/contentreviews">Content Review</a>
				</li>
				<li>
					<a href="/faqs/content_types">Content Types</a>
				</li>
				<li>
					<a href="/faqs/content_upload">Content Upload</a>
				</li>
				<li>
					<a href="/faqs/feature">Features</a>
				</li>
				<li>
					<a href="/faqs/fixerrors">Fix Errors</a>
				</li>
				<li>
					<a href="/faqs/glossary">Glossary</a>
				</li>
				<li>
					<a href="/faqs/helpsupport">Help Support</a>
				</li>
				<li>
					<a href="/faqs/intellectual_propertylicensesstandards">Intellectual Property Licenses Standards</a>
				</li>
				<li>
					<a href="/faqs/registrationenrolment">Registration Enrollment</a>
				</li>
				<li>
					<a href="/faqs/signin">Sign In</a>
				</li>
				<li>
					<a href="/faqs/taxonomymetadataframework">Taxonomy Meta Data Framework</a>
				</li>
				<li>
					<a href="/faqs/user_rightspermissions">Users Rights Permission</a>
				</li>
			</ul>
		</div>
	</div>
</div>

      </div>
     <!-- <div class="inner__supportbar">
        <a href="#">Help & Support</a>
      </div>-->
    </nav>
    <div class="content">
      <div class="inner__content header">

        <h1>Medium Scale Deployment </h1>

        
          <span class="hide-selector"><script type="text/javascript">$(function() { React.render(React.createElement(SectionSelector, {current_path: "developer-docs/medium_scale_deploy", site_map: {"marketing-channels":{},"cross-channel-analytics":{},"data-exchange":{},"basic-setup":{},"next-steps":{},"github-sdks":{},"getting-started":{},"other":{}}, sections: [{"key":"overview","name":"Overview"},{"key":"guide","name":"Guide"},{"key":"support","name":"Support"},{"key":"advanced","name":"Advanced"},{"key":"examples","name":"Examples"}], platforms: {}, url_section: ""}), $("#qw95z9pgts8")[0]); });</script><div id="qw95z9pgts8"><div class="section-selector" data-reactid=".4ht2mief14" data-react-checksum="-1661333475"><div class="section-group" data-reactid=".4ht2mief14.0"><a class="section section-inactive" href="/developer-docs/medium_scale_deploy/" data-reactid=".4ht2mief14.0.$overview">Overview</a><a class="section section-inactive" href="/developer-docs/medium_scale_deploy//" data-reactid=".4ht2mief14.0.$guide">Guide</a><a class="section section-inactive" href="/developer-docs/medium_scale_deploy//" data-reactid=".4ht2mief14.0.$support">Support</a><a class="section section-inactive" href="/developer-docs/medium_scale_deploy//" data-reactid=".4ht2mief14.0.$advanced">Advanced</a><a class="section section-inactive" href="/developer-docs/medium_scale_deploy//" data-reactid=".4ht2mief14.0.$examples">Examples</a></div></div></div></span>
        
      </div>

      

      <div id="main-content" class="inner__content">
        
          <h1 id="medium-scale-deployment-of-sunbird">Medium scale Deployment of Sunbird</h1>

<h2 id="prerequisites">Prerequisites</h2>
<p>This section should expand as open source contributions to support multiple run times increase over time. Presently, the software and reference steps consider the following tech stack:</p>

<p>Required:
- Linux, preferably Ubuntu
- <a href="https://docs.docker.com/engine/swarm/">Docker Swarm Mode</a>
- <a href="https://www.ansible.com/">Ansible</a></p>

<p>Optional:
- A CI server, e.x. <a href="https://jenkins.io/">Jenkins</a>, to build extensions and take future upgrades
- a source control mechanism, e.x. <a href="https://github.com/">Git</a></p>

<h2 id="installation">Installation</h2>

<h3 id="production">Production</h3>
<p>You have a choice to use bare metal machines or go with a Cloud provider of your choice, which can provide you Linux runtime with root access. Initial scripts contain automation to setup Sunbird on <a href="https://azure.microsoft.com/en-in/">Azure</a> and assume that you have a Unix runtime on the machine you are initiating the installation.
- Create a RSA 2048 bit SSH keypair
- Set up Docker Swarm Mode using <a href="https://github.com/Azure/acs-engine">ACS-Engine</a>
- Bootstrap the servers using <a href="#machine-bootstrap">Bootstrap script</a>
- SSH into Master node
- Clone <a href="https://github.com/project-sunbird/sunbird-devops">this repo</a>
- Bootstrap <a href="#configuration-bootstrap">configuration</a>
- Install <a href="#database-installations">databases</a>
- Bootstrap <a href="#database-bootstrap">databases</a>
- Deploy <a href="#service-deploy">services</a></p>

<h2 id="installation-details">Installation Details</h2>
<p>Getting started with installation can be a daunting task. Fortunately, we’ve simplified the installation process.</p>

<h3 id="machine-bootstrap">Machine bootstrap</h3>
<p>This bootstraps the VMs with initial configuration needed for automated script access.
<code>
ansible-playbook -i inventory/? --tags "bootstrap_any" -e "hosts=?" -e "bootstrap_secret_file=production" bootstrap.yml --ask-vault-pass
</code></p>

<h3 id="configuration-bootstrap">Configuration bootstrap</h3>
<p>Typically, this step configures the production environment with the basic configuration required to boot up services, e.x. DB connection strings, secrets, etc</p>

<p><code>ansible-playbook -i ansible/inventory/? ansible/bootstrap.yml --extra-vars hosts=production-swarm-manager swarm_master=true --tags bootstrap_swarm --vault-password-file /run/secrets/vault-pass</code></p>

<h3 id="install-database">Install Database</h3>

<p>Sunbird uses <a href="https://www.mongodb.com/">Mongo</a>, <a href="http://cassandra.apache.org/">Cassandra</a>, <a href="https://www.postgresql.org/">Postgres</a> and <a href="https://www.elastic.co/products/elasticsearch">Elasticsearch</a> for various scaleable persistence and query needs.</p>

<p>This repo contains provisioning scripts for DBs at <a href="https://github.com/project-sunbird/sunbird-devops/blob/master/ansible/provision.yml">ansible/provision.yml</a>. You may use these or setup/reuse DB as appropriate in your deployment environments.</p>

<p>All DBs have Backup and Restore <a href="https://github.com/project-sunbird/sunbird-devops/tree/master/ansible">scripts</a>.</p>

<h3 id="service-deploy">Service deploy</h3>
<p>Sunbird has a set of services, serving separate functional needs. Refer to <a href="https://github.com/project-sunbird/sunbird-commons">sunbird-commons</a> for a better understanding of the service oriented design.</p>

<h4 id="api-manager">API Manager</h4>

<p><code>METADATA_FILE=? ARTIFACT_LABEL=gold ENV=production ./pipelines/api-manager/deploy.sh</code></p>

<h4 id="proxy">Proxy</h4>

<p><code>METADATA_FILE=? ARTIFACT_LABEL=gold ENV=production ./pipelines/proxy/deploy.sh</code></p>

<h4 id="frontend">FrontEnd</h4>

<h5 id="player">Player</h5>

<p><code>METADATA_FILE=? ENV=production ARTIFACT_LABEL=gold ./pipelines/sunbird-player/deploy.sh</code></p>

<h4 id="middleware">Middleware</h4>

<h5 id="actor-service">Actor Service</h5>

<p><code>METADATA_FILE=? ENV=production ARTIFACT_LABEL=gold ./pipelines/sunbird-actor-service/deploy.sh</code></p>

<h5 id="content-service">Content Service</h5>

<p><code>METADATA_FILE=? ENV=production ARTIFACT_LABEL=gold ./pipelines/sunbird-content-service/deploy.sh</code></p>

<h5 id="learner-service">Learner Service</h5>

<p><code>METADATA_FILE=? ENV=ntp-production ARTIFACT_LABEL=gold ./pipelines/sunbird-learner-service/deploy.sh</code>
<code>METADATA_FILE</code> describes the version needed for deployment.</p>

<p>.</p>

        
      </div>
    </div>
  </div>

  <script>
    var platformSelector = $("#platform-selector");
    var mainContent = $("#main-content");

    $(".content").scroll(function() {

      if (this.scrollTop > 264) {
        platformSelector.addClass("fixed");
        mainContent.addClass("no-selector");
      }
      else {
        platformSelector.removeClass("fixed");
        mainContent.removeClass("no-selector");
      }

    });
  </script>

  <script type="text/javascript">

      $(document).ready(function(){
          $('#dropdown-trigger').click(function(e){
              var $elm = $('#mobile-dropdown');
              if($elm.is(":visible")){
                  $elm.stop().slideUp();
              }else{
                  $elm.stop().slideDown();
                  $('html,body').scrollTop(0);
              }
              e.stopPropagation();
          });
      });

  </script>

  </body>

</html>
